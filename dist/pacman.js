!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=14)}([function(t,e,i){var s={},o=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),n=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var s=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,i);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}}(),r=null,h=0,a=[],c=i(1);function d(t,e){for(var i=0;i<t.length;i++){var o=t[i],n=s[o.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](o.parts[r]);for(;r<o.parts.length;r++)n.parts.push(m(o.parts[r],e))}else{var h=[];for(r=0;r<o.parts.length;r++)h.push(m(o.parts[r],e));s[o.id]={id:o.id,refs:1,parts:h}}}}function l(t,e){for(var i=[],s={},o=0;o<t.length;o++){var n=t[o],r=e.base?n[0]+e.base:n[0],h={css:n[1],media:n[2],sourceMap:n[3]};s[r]?s[r].parts.push(h):i.push(s[r]={id:r,parts:[h]})}return i}function u(t,e){var i=n(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var s=a[a.length-1];if("top"===t.insertAt)s?s.nextSibling?i.insertBefore(e,s.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),a.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=n(t.insertAt.before,i);i.insertBefore(e,o)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=a.indexOf(t);e>=0&&a.splice(e,1)}function f(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var s=function(){0;return i.nc}();s&&(t.attrs.nonce=s)}return g(e,t.attrs),u(t,e),e}function g(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function m(t,e){var i,s,o,n;if(e.transform&&t.css){if(!(n="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=n}if(e.singleton){var a=h++;i=r||(r=f(e)),s=w.bind(null,i,a,!1),o=w.bind(null,i,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(e,t.attrs),u(t,e),e}(e),s=function(t,e,i){var s=i.css,o=i.sourceMap,n=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||n)&&(s=c(s));o&&(s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([s],{type:"text/css"}),h=t.href;t.href=URL.createObjectURL(r),h&&URL.revokeObjectURL(h)}.bind(null,i,e),o=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=f(e),s=function(t,e){var i=e.css,s=e.media;s&&t.setAttribute("media",s);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),o=function(){p(i)});return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=l(t,e);return d(i,e),function(t){for(var o=[],n=0;n<i.length;n++){var r=i[n];(h=s[r.id]).refs--,o.push(h)}t&&d(l(t,e),e);for(n=0;n<o.length;n++){var h;if(0===(h=o[n]).refs){for(var a=0;a<h.parts.length;a++)h.parts[a]();delete s[h.id]}}}};var v=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}();function w(t,e,i,s){var o=i?"":s.css;if(t.styleSheet)t.styleSheet.cssText=v(e,o);else{var n=document.createTextNode(o),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(n,r[e]):t.appendChild(n)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,s=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,n=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(n)?t:(o=0===n.indexOf("//")?n:0===n.indexOf("/")?i+n:s+n.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e);i(15),i(17),i(19)},function(t,e,i){var s=i(16);"string"==typeof s&&(s=[[t.i,s,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(0)(s,o);s.locals&&(t.exports=s.locals)},function(t,e,i){},function(t,e,i){var s=i(18);"string"==typeof s&&(s=[[t.i,s,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(0)(s,o);s.locals&&(t.exports=s.locals)},function(t,e,i){},function(t,e,i){"use strict";!function(){var t,e,i,s,o,n,r,h,a,c="data/map.json";function d(){setTimeout(l,30)}function l(){var t=(new Date).getTime();$.ajax({datatype:"json",type:"GET",url:"data/db-handler.php",data:{timestamp:t,action:"get"},success:function(t){$("#highscore-list").text("");for(var e=0;e<t.length;e++)$("#highscore-list").append("<li>"+t[e].name+"<span id='score'>"+t[e].score+"</span></li>")}})}function u(){var t=$("input[type=text]").val();$("#highscore-form").html("Saving highscore..."),function(t,e,i){$.ajax({type:"POST",url:"data/db-handler.php",data:{action:"add",name:t,score:e,level:i},dataType:"json",success:function(t){console.log("Highscore added: "+t),$("#highscore-form").html('<span class="button" id="show-highscore">View Highscore List</span>')},error:function(t){console.log(t)}})}(t,i.score.score,i.level)}function p(t,e,i,s,o){console.log("BuildWall"),s=2*s-1,o=2*o-1,t.fillRect(z.radius/2+2*e*z.radius,z.radius/2+2*i*z.radius,s*z.radius,o*z.radius)}function f(t,e,i){return t>=e&&t<=i}var g=function(){var t=null,e={enableLogger:function(){null!==t&&(window.console.log=t)},disableLogger:function(){t=console.log,window.console.log=function(){}}};return e}();i=new function(){this.timer=new function(){this.time_diff=0,this.time_start=0,this.time_stop=0,this.start=function(){this.time_start=(new Date).getTime()},this.stop=function(){this.time_stop=(new Date).getTime(),this.time_diff+=this.time_stop-this.time_start,this.time_stop=0,this.time_start=0},this.reset=function(){this.time_diff=0,this.time_start=0,this.time_stop=0},this.get_time_diff=function(){return this.time_diff}},this.refreshRate=33,this.running=!1,this.pause=!0,this.score=new function(){this.score=0,this.set=function(t){this.score=t},this.add=function(t){this.score+=t},this.refresh=function(t){$(t).html("Score: "+this.score)}},this.soundfx=0,this.map,this.pillCount,this.monsters,this.level=1,this.refreshLevel=function(t){$(t).html("Lvl: "+this.level)},this.gameOver=!1,this.canvas=$("#myCanvas").get(0),this.wallColor="Blue",this.width=this.canvas.width,this.height=this.canvas.height,this.pillSize=3,this.powerpillSizeMin=2,this.powerpillSizeMax=6,this.powerpillSizeCurrent=this.powerpillSizeMax,this.powerPillAnimationCounter=0,this.nextPowerPillSize=function(){return this.powerpillSizeCurrent},this.ghostFrightened=!1,this.ghostFrightenedTimer=240,this.ghostMode=0,this.ghostModeTimer=200,this.ghostSpeedNormal=this.level>4?3:2,this.ghostSpeedDazzled=2,this.startGhostFrightened=function(){console.log("ghost frigthened"),this.ghostFrightened=!0,this.ghostFrightenedTimer=240,n.dazzle(),a.dazzle(),r.dazzle(),h.dazzle()},this.endGhostFrightened=function(){console.log("ghost frigthened end"),this.ghostFrightened=!1,n.undazzle(),a.undazzle(),r.undazzle(),h.undazzle()},this.checkGhostMode=function(){this.ghostFrightened&&(this.ghostFrightenedTimer--,0===this.ghostFrightenedTimer&&(this.endGhostFrightened(),this.ghostFrigthenedTimer=240)),this.ghostModeTimer--,0===this.ghostModeTimer&&i.level>1&&(this.ghostMode^=1,this.ghostModeTimer=200+450*this.ghostMode,console.log("ghostMode="+this.ghostMode),i.buildWalls(),n.reverseDirection(),a.reverseDirection(),h.reverseDirection(),r.reverseDirection())},this.getMapContent=function(t,e){var s=i.width/30-1,o=i.height/30-1;return t<0&&(t=s+t),t>s&&(t-=s),e<0&&(e=o+e),e>o&&(e-=o),this.map.posY[e].posX[t].type},this.setMapContent=function(t,e,i){this.map.posY[e].posX[t].type=i},this.toggleSound=function(){0===this.soundfx?this.soundfx=1:this.soundfx=0,$("#mute").toggle()},this.reset=function(){},this.newGame=function(){confirm("Are you sure you want to restart?")&&(console.log("new Game"),this.init(0),this.pauseResume())},this.nextLevel=function(){this.level++,console.log("Level "+i.level),i.showMessage("Level "+i.level,this.getLevelTitle()+"<br/>(Click to continue!)"),i.refreshLevel(".level"),this.init(1)},this.drawHearts=function(t){for(var e="",i=0;i<t;i++)e+=" <img src='img/heart.png'>";$(".lives").html("Lives: "+e)},this.showContent=function(t){$(".content").hide(),$("#"+t).show()},this.getLevelTitle=function(){switch(this.level){case 2:return'"The chase begins"';case 3:return'"Inkys awakening"';case 4:return'"Clydes awakening"';case 5:return'"need for speed"';case 6:return'"hunting season 1"';case 7:return'"the big calm"';case 8:return'"hunting season 2"';case 9:return'"ghosts on speed"';default:return'"nothing new"'}},this.showMessage=function(t,e){this.timer.stop(),this.pause=!0,$("#canvas-overlay-container").fadeIn(200),"none"!=$(".controls").css("display")&&$(".controls").slideToggle(200),$("#canvas-overlay-content #title").text(t),$("#canvas-overlay-content #text").html(e)},this.closeMessage=function(){$("#canvas-overlay-container").fadeOut(200),$(".controls").slideToggle(200)},this.pauseResume=function(){this.running?this.pause?(this.timer.stop(),this.pause=!1,this.closeMessage()):this.showMessage("Pause","Click to Resume"):(this.timer.start(),this.pause=!1,this.running=!0,this.closeMessage(),C())},this.init=function(t){console.log("init game "+t),0===t&&this.timer.reset(),$.ajax({url:c,async:!1,beforeSend:function(t){t.overrideMimeType&&t.overrideMimeType("application/json")},dataType:"json",success:function(t){i.map=t}});var e=0;$.each(this.map.posY,function(t,i){$.each(this.posX,function(){"pill"==this.type&&e++})}),this.pillCount=e,0===t&&(this.score.set(0),this.score.refresh(".score"),z.lives=3,i.level=1,this.refreshLevel(".level"),i.gameOver=!1),z.reset(),i.drawHearts(z.lives),this.ghostFrightened=!1,this.ghostFrightenedTimer=240,this.ghostMode=0,this.ghostModeTimer=200,null===a||void 0===a?(a=new P("pinky",7,5,"img/pinky.svg",2,2),n=new P("inky",8,5,"img/inky.svg",13,11),r=new P("blinky",9,5,"img/blinky.svg",13,0),h=new P("clyde",10,5,"img/clyde.svg",2,11)):(a.reset(),n.reset(),r.reset(),h.reset()),r.start(),n.start(),a.start(),h.start()},this.check=function(){0===this.pillCount&&i.running&&this.nextLevel()},this.win=function(){},this.gameover=function(){},this.toPixelPos=function(t){return 30*t},this.toGridPos=function(t){return t%30/30},this.buildWalls=function(){0===this.ghostMode?i.wallColor="Blue":i.wallColor="Red",(s=document.createElement("canvas")).width=i.canvas.width,s.height=i.canvas.height,(o=s.getContext("2d")).fillStyle=i.wallColor,o.strokeStyle=i.wallColor,p(o,0,0,18,1),p(o,0,12,18,1),p(o,0,0,1,6),p(o,0,7,1,6),p(o,17,0,1,6),p(o,17,7,1,6),p(o,7,4,1,1),p(o,6,5,1,2),p(o,10,4,1,1),p(o,11,5,1,2),p(o,6,6,6,1),o.fillRect(16*z.radius,z.radius/2+8*z.radius+5,4*z.radius,1),p(o,4,0,1,2),p(o,13,0,1,2),p(o,2,2,1,2),p(o,6,2,2,1),p(o,15,2,1,2),p(o,10,2,2,1),p(o,2,3,2,1),p(o,14,3,2,1),p(o,5,3,1,1),p(o,12,3,1,1),p(o,3,3,1,3),p(o,14,3,1,3),p(o,3,4,1,1),p(o,14,4,1,1),p(o,0,5,2,1),p(o,3,5,2,1),p(o,16,5,2,1),p(o,13,5,2,1),p(o,0,7,2,2),p(o,16,7,2,2),p(o,3,7,2,2),p(o,13,7,2,2),p(o,4,8,2,2),p(o,12,8,2,2),p(o,5,8,3,1),p(o,10,8,3,1),p(o,2,10,1,1),p(o,15,10,1,1),p(o,7,10,4,1),p(o,4,11,2,2),p(o,12,11,2,2)}};var m={};function v(t,e,i,s,o){this.name=t,this.angle1=e,this.angle2=i,this.dirX=s,this.dirY=o,this.equals=function(t){return JSON.stringify(this)==JSON.stringify(t)}}m.play=function(t){if(1==i.soundfx){var e=document.getElementById(t);null!==e?e.play():console.log(t+" not found")}};var w=new v("up",1.75,1.25,0,-1),y=new v("left",1.25,.75,-1,0),b=new v("down",.75,.25,0,1),X=new v("right",.25,1.75,1,0);function Y(){this.dir=null,this.set=function(t){this.dir=t},this.get=function(){return this.dir}}function P(t,e,s,o,n,h){this.name=t,this.posX=30*e,this.posY=30*s,this.startPosX=30*e,this.startPosY=30*s,this.gridBaseX=n,this.gridBaseY=h,this.speed=i.ghostSpeedNormal,this.images=JSON.parse('{"normal" : {"inky" : "0","pinky" : "1","blinky" : "2","clyde" : "3"},"frightened1" : {"left" : "", "up": "", "right" : "", "down": ""},"frightened2" : {"left" : "", "up": "", "right" : "", "down": ""},"dead" : {"left" : "", "up": "", "right" : "", "down": ""}}'),this.image=new Image,this.image.src=o,this.ghostHouse=!0,this.dazzled=!1,this.dead=!1,this.dazzle=function(){this.changeSpeed(i.ghostSpeedDazzled),this.posX>0&&(this.posX=this.posX-this.posX%this.speed),this.posY>0&&(this.posY=this.posY-this.posY%this.speed),this.dazzled=!0},this.undazzle=function(){this.dead||this.changeSpeed(i.ghostSpeedNormal),this.posX>0&&(this.posX=this.posX-this.posX%this.speed),this.posY>0&&(this.posY=this.posY-this.posY%this.speed),this.dazzled=!1},this.dazzleImg=new Image,this.dazzleImg.src="img/dazzled.svg",this.dazzleImg2=new Image,this.dazzleImg2.src="img/dazzled2.svg",this.deadImg=new Image,this.deadImg.src="img/dead.svg",this.direction=X,this.radius=z.radius,this.draw=function(t){this.dead?t.drawImage(this.deadImg,this.posX,this.posY,2*this.radius,2*this.radius):this.dazzled?z.beastModeTimer<50&&z.beastModeTimer%8>1?t.drawImage(this.dazzleImg2,this.posX,this.posY,2*this.radius,2*this.radius):t.drawImage(this.dazzleImg,this.posX,this.posY,2*this.radius,2*this.radius):t.drawImage(this.image,this.posX,this.posY,2*this.radius,2*this.radius)},this.getCenterX=function(){return this.posX+this.radius},this.getCenterY=function(){return this.posY+this.radius},this.reset=function(){this.dead=!1,this.posX=this.startPosX,this.posY=this.startPosY,this.ghostHouse=!0,this.undazzle()},this.die=function(){this.dead||(i.score.add(100),this.dead=!0,this.changeSpeed(i.ghostSpeedNormal))},this.changeSpeed=function(t){this.posX=Math.round(this.posX/t)*t,this.posY=Math.round(this.posY/t)*t,this.speed=t},this.move=function(){this.checkDirectionChange(),this.checkCollision(),1==this.ghostHouse&&("clyde"==this.name&&(i.level<4||i.pillCount>104/3?this.stop=!0:this.stop=!1),"inky"==this.name&&(i.level<3||i.pillCount>74?this.stop=!0:this.stop=!1),5==this.getGridPosY()&&this.inGrid()&&(7==this.getGridPosX()&&this.setDirection(X),8!=this.getGridPosX()&&9!=this.getGridPosX()||this.setDirection(w),10==this.getGridPosX()&&this.setDirection(y)),4!=this.getGridPosY()||8!=this.getGridPosX()&&9!=this.getGridPosX()||!this.inGrid()||(console.log("ghosthouse -> false"),this.ghostHouse=!1)),this.stop||(this.posX+=this.speed*this.dirX,this.posY+=this.speed*this.dirY,this.posX>=i.width-this.radius&&(this.posX=this.speed-this.radius),this.posX<=0-this.radius&&(this.posX=i.width-this.speed-this.radius),this.posY>=i.height-this.radius&&(this.posY=this.speed-this.radius),this.posY<=0-this.radius&&(this.posY=i.height-this.speed-this.radius))},this.checkCollision=function(){this.dead&&this.getGridPosX()==this.startPosX/30&&this.getGridPosY()==this.startPosY/30?this.reset():f(z.getCenterX(),this.getCenterX()-10,this.getCenterX()+10)&&f(z.getCenterY(),this.getCenterY()-10,this.getCenterY()+10)&&(this.dazzled||this.dead?this.die():z.die())},this.getNextDirection=function(){var t=this.getGridPosX(),e=this.getGridPosY();if(i.getMapContent(t,e),this.dead)var s=this.startPosX/30,o=this.startPosY/30;else if(0==i.ghostMode)s=this.gridBaseX,o=this.gridBaseY;else if(1==i.ghostMode)switch(this.name){case"pinky":var n=z.direction,h=0==n.dirX?-n.dirY:n.dirX,a=0==n.dirY?-n.dirX:n.dirY;s=(z.getGridPosX()+4*h)%(i.width/z.radius+1),o=(z.getGridPosY()+4*a)%(i.height/z.radius+1);break;case"blinky":s=z.getGridPosX(),o=z.getGridPosY();break;case"inky":s=z.getGridPosX()+2*z.direction.dirX,o=z.getGridPosY()+2*z.direction.dirY;var c=s-r.getGridPosX(),d=o-r.getGridPosY();s=Math.abs(r.getGridPosX()+2*c),o=Math.abs(r.getGridPosY()+2*d);break;case"clyde":s=z.getGridPosX(),o=z.getGridPosY(),Math.sqrt(Math.pow(t-s,2)+Math.pow(e-o,2))<5&&(s=this.gridBaseX,o=this.gridBaseY)}this.getOppositeDirection();var l=[{},{},{},{}];l[0].field=i.getMapContent(t,e-1),l[0].dir=w,l[0].distance=Math.sqrt(Math.pow(t-s,2)+Math.pow(e-1-o,2)),l[1].field=i.getMapContent(t,e+1),l[1].dir=b,l[1].distance=Math.sqrt(Math.pow(t-s,2)+Math.pow(e+1-o,2)),l[2].field=i.getMapContent(t+1,e),l[2].dir=X,l[2].distance=Math.sqrt(Math.pow(t+1-s,2)+Math.pow(e-o,2)),l[3].field=i.getMapContent(t-1,e),l[3].dir=y,l[3].distance=Math.sqrt(Math.pow(t-1-s,2)+Math.pow(e-o,2));var u=l.sort(function(t,e){return t.distance<e.distance?-1:t.distance>e.distance?1:0}),p=this.dir;if(this.dead)for(var f=u.length-1;f>=0;f--)"wall"==u[f].field||u[f].dir.equals(this.getOppositeDirection())||(p=u[f].dir);else for(f=u.length-1;f>=0;f--)"wall"==u[f].field||"door"==u[f].field||u[f].dir.equals(this.getOppositeDirection())||(p=u[f].dir);return this.directionWatcher.set(p),p},this.setRandomDirection=function(){switch(Math.floor(10*Math.random()+1)%5){case 1:this.getOppositeDirection().equals(w)?this.setDirection(b):this.setDirection(w);break;case 2:this.getOppositeDirection().equals(b)?this.setDirection(w):this.setDirection(b);break;case 3:this.getOppositeDirection().equals(X)?this.setDirection(y):this.setDirection(X);break;case 4:this.getOppositeDirection().equals(y)?this.setDirection(X):this.setDirection(y)}},this.reverseDirection=function(){console.log("reverseDirection: "+this.direction.name+" to "+this.getOppositeDirection().name),this.directionWatcher.set(this.getOppositeDirection())}}function M(){this.posX,this.posY,this.speed,this.dirX=X.dirX,this.dirY=X.dirY,this.direction,this.stop=!0,this.directionWatcher=new Y,this.getNextDirection=function(){console.log("Figure getNextDirection")},this.checkDirectionChange=function(){this.inGrid()&&null==this.directionWatcher.get()&&this.getNextDirection(),null!=this.directionWatcher.get()&&this.inGrid()&&(this.setDirection(this.directionWatcher.get()),this.directionWatcher.set(null))},this.inGrid=function(){return this.posX%(2*this.radius)==0&&this.posY%(2*this.radius)==0},this.getOppositeDirection=function(){return this.direction.equals(w)?b:this.direction.equals(b)?w:this.direction.equals(X)?y:this.direction.equals(y)?X:void 0},this.move=function(){this.stop||(this.posX+=this.speed*this.dirX,this.posY+=this.speed*this.dirY,this.posX>=i.width-this.radius&&(this.posX=this.speed-this.radius),this.posX<=0-this.radius&&(this.posX=i.width-this.speed-this.radius),this.posY>=i.height-this.radius&&(this.posY=this.speed-this.radius),this.posY<=0-this.radius&&(this.posY=i.height-this.speed-this.radius))},this.stop=function(){this.stop=!0},this.start=function(){this.stop=!1},this.getGridPosX=function(){return(this.posX-this.posX%30)/30},this.getGridPosY=function(){return(this.posY-this.posY%30)/30},this.setDirection=function(t){this.dirX=t.dirX,this.dirY=t.dirY,this.angle1=t.angle1,this.angle2=t.angle2,this.direction=t},this.setPosition=function(t,e){this.posX=t,this.posY=e}}function z(){this.radius=15,this.posX=0,this.posY=12*this.radius,this.speed=5,this.angle1=.25,this.angle2=1.75,this.mouth=1,this.dirX=X.dirX,this.dirY=X.dirY,this.lives=3,this.stuckX=0,this.stuckY=0,this.frozen=!1,this.freeze=function(){this.frozen=!0},this.unfreeze=function(){this.frozen=!1},this.getCenterX=function(){return this.posX+this.radius},this.getCenterY=function(){return this.posY+this.radius},this.directionWatcher=new Y,this.direction=X,this.beastMode=!1,this.beastModeTimer=0,this.checkCollisions=function(){if(0==this.stuckX&&0==this.stuckY&&0==this.frozen){var t=this.getGridPosX(),e=this.getGridPosY(),s=t,o=e,n=i.getMapContent(t,e);1==this.dirX&&s<17&&(s+=1),1==this.dirY&&o<12&&(o+=1);var r,h=i.getMapContent(s,o);"pill"!==n&&"powerpill"!==n||(1==this.dirX&&f(this.posX,i.toPixelPos(t)+this.radius-5,i.toPixelPos(t+1))||-1==this.dirX&&f(this.posX,i.toPixelPos(t),i.toPixelPos(t)+5)||1==this.dirY&&f(this.posY,i.toPixelPos(e)+this.radius-5,i.toPixelPos(e+1))||-1==this.dirY&&f(this.posY,i.toPixelPos(e),i.toPixelPos(e)+5)||"wall"===h)&&("powerpill"===n?(m.play("powerpill"),r=50,this.enableBeastMode(),i.startGhostFrightened()):(m.play("waka"),r=10,i.pillCount--),i.map.posY[e].posX[t].type="null",i.score.add(r)),"wall"!==h&&"door"!==h||(this.stuckX=this.dirX,this.stuckY=this.dirY,z.stop(),1==this.stuckX&&this.posX%2*this.radius!=0&&(this.posX-=5),1==this.stuckY&&this.posY%2*this.radius!=0&&(this.posY-=5),-1==this.stuckX&&(this.posX+=5),-1==this.stuckY&&(this.posY+=5))}},this.checkDirectionChange=function(){if(null!=this.directionWatcher.get())if(1==this.stuckX&&this.directionWatcher.get()==X)this.directionWatcher.set(null);else if(this.stuckX=0,this.stuckY=0,this.inGrid()){console.log("x: "+this.getGridPosX()+" + "+this.directionWatcher.get().dirX),console.log("y: "+this.getGridPosY()+" + "+this.directionWatcher.get().dirY);var t=this.getGridPosX()+this.directionWatcher.get().dirX,e=this.getGridPosY()+this.directionWatcher.get().dirY;t<=-1&&(t=i.width/(2*this.radius)-1),t>=i.width/(2*this.radius)&&(t=0),e<=-1&&(t=i.height/(2*this.radius)-1),e>=i.heigth/(2*this.radius)&&(e=0),console.log("x: "+t),console.log("y: "+e);var s=i.map.posY[e].posX[t].type;console.log("checkNextTile: "+s),"wall"!=s&&(this.setDirection(this.directionWatcher.get()),this.directionWatcher.set(null))}},this.setDirection=function(t){this.frozen||(this.dirX=t.dirX,this.dirY=t.dirY,this.angle1=t.angle1,this.angle2=t.angle2,this.direction=t)},this.enableBeastMode=function(){this.beastMode=!0,this.beastModeTimer=240,n.dazzle(),a.dazzle(),r.dazzle(),h.dazzle()},this.disableBeastMode=function(){this.beastMode=!1,n.undazzle(),a.undazzle(),r.undazzle(),h.undazzle()},this.move=function(){this.frozen?this.dieAnimation():(this.beastModeTimer>0&&this.beastModeTimer--,0==this.beastModeTimer&&1==this.beastMode&&this.disableBeastMode(),this.posX+=this.speed*this.dirX,this.posY+=this.speed*this.dirY,this.posX>=i.width-this.radius&&(this.posX=5-this.radius),this.posX<=0-this.radius&&(this.posX=i.width-5-this.radius),this.posY>=i.height-this.radius&&(this.posY=5-this.radius),this.posY<=0-this.radius&&(this.posY=i.height-5-this.radius))},this.eat=function(){if(!this.frozen&&this.dirX==this.dirY==0){this.angle1-=.07*this.mouth,this.angle2+=.07*this.mouth;var t=this.direction.angle1,e=this.direction.angle2,i=this.direction.angle1-.21,s=this.direction.angle2+.21;(this.angle1<i||this.angle2>s)&&(this.mouth=-1),(this.angle1>=t||this.angle2<=e)&&(this.mouth=1)}},this.stop=function(){this.dirX=0,this.dirY=0},this.reset=function(){this.unfreeze(),this.posX=0,this.posY=12*this.radius,this.setDirection(X),this.stop(),this.stuckX=0,this.stuckY=0},this.dieAnimation=function(){this.angle1+=.05,this.angle2-=.05,(this.angle1>=this.direction.angle1+.7||this.angle2<=this.direction.angle2-.7)&&this.dieFinal()},this.die=function(){m.play("die"),this.freeze(),this.dieAnimation()},this.dieFinal=function(){this.reset(),a.reset(),n.reset(),r.reset(),h.reset(),this.lives--,console.log("pacman died, "+this.lives+" lives left"),this.lives<=0&&(i.showMessage("Game over","Total Score: "+i.score.score+"<div id='highscore-form'><span id='form-validater'></span><input type='text' id='playerName'/><span class='button' id='score-submit'>save</span></div>"),i.gameOver=!0,$("#playerName").focus()),i.drawHearts(this.lives)},this.getGridPosX=function(){return(this.posX-this.posX%30)/30},this.getGridPosY=function(){return(this.posY-this.posY%30)/30}}P.prototype=new M,z.prototype=new M;var z=new z;function k(){var t;i.score.refresh(".score"),e.beginPath(),e.fillStyle="White",e.strokeStyle="White",$.each(i.map.posY,function(s,o){t=this.row,$.each(this.posX,function(){"pill"==this.type?(e.arc(i.toPixelPos(this.col-1)+z.radius,i.toPixelPos(t-1)+z.radius,i.pillSize,0*Math.PI,2*Math.PI),e.moveTo(i.toPixelPos(this.col-1),i.toPixelPos(t-1))):"powerpill"==this.type&&(e.arc(i.toPixelPos(this.col-1)+z.radius,i.toPixelPos(t-1)+z.radius,i.powerpillSizeCurrent,0*Math.PI,2*Math.PI),e.moveTo(i.toPixelPos(this.col-1),i.toPixelPos(t-1)))})}),console.log("pps: "+i.nextPowerPillSize()),e.fill(),e.drawImage(s,0,0),1==i.running&&(a.draw(e),r.draw(e),n.draw(e),h.draw(e),e.beginPath(),e.fillStyle="Yellow",e.strokeStyle="Yellow",e.arc(z.posX+z.radius,z.posY+z.radius,z.radius,z.angle1*Math.PI,z.angle2*Math.PI),e.lineTo(z.posX+z.radius,z.posY+z.radius),e.stroke(),e.fill())}function C(){t.width=t.width,k(),1==i.dieAnimation&&z.dieAnimation(),1!=i.pause&&(z.move(),z.eat(),z.checkDirectionChange(),z.checkCollisions(),r.move(),n.move(),a.move(),h.move(),i.checkGhostMode()),i.check(),setTimeout(C,i.refreshRate)}function x(t){switch(t.keyCode){case 38:t.preventDefault();case 87:z.directionWatcher.set(w);break;case 40:t.preventDefault();case 83:z.directionWatcher.set(b);break;case 37:t.preventDefault();case 65:z.directionWatcher.set(y);break;case 39:t.preventDefault();case 68:z.directionWatcher.set(X);break;case 78:$("#playerName").is(":focus")||(i.pause=1,i.newGame());break;case 77:i.toggleSound();break;case 8:case 27:$("#playerName").is(":focus")||(t.preventDefault(),i.showContent("game-content"));break;case 32:t.preventDefault(),1!=i.gameOver&&$("#game-content").is(":visible")&&i.pauseResume()}}i.buildWalls(),$(document).ready(function(){$.ajaxSetup({mimeType:"application/json"}),$.ajaxSetup({beforeSend:function(t){t.overrideMimeType&&t.overrideMimeType("application/json")}}),console.log("hide adressbar"),$("html").scrollTop(1),$("body").scrollTop(1),null!=window.applicationCache&&(console.log("check AppCache"),window.applicationCache.addEventListener("updateready",function(t){console.log("AppCache: updateready"),window.applicationCache.status==window.applicationCache.UPDATEREADY&&(window.applicationCache.swapCache(),confirm("A new version of this site is available. Load it?")&&window.location.reload())},!1),window.applicationCache.addEventListener("cached",function(t){console.log("AppCache: cached")},!1)),window.addEventListener("keydown",x,!0),$("#canvas-container").click(function(){1!=i.gameOver&&i.pauseResume()}),$("body").on("click","#score-submit",function(){console.log("submit highscore pressed"),""===$("#playerName").val()||void 0===$("#playerName").val()?$("#form-validater").html("Please enter a name<br/>"):($("#form-validater").html(""),u())}),$("body").on("click","#show-highscore",function(){i.showContent("highscore-content"),d()}),Hammer(".container").on("swiperight",function(t){$("#game-content").is(":visible")&&(t.gesture.preventDefault(),z.directionWatcher.set(X))}),Hammer(".container").on("swipeleft",function(t){$("#game-content").is(":visible")&&(t.gesture.preventDefault(),z.directionWatcher.set(y))}),Hammer(".container").on("swipeup",function(t){$("#game-content").is(":visible")&&(t.gesture.preventDefault(),z.directionWatcher.set(w))}),Hammer(".container").on("swipedown",function(t){$("#game-content").is(":visible")&&(t.gesture.preventDefault(),z.directionWatcher.set(b))}),$(document).on("touchend mousedown","#up",function(t){t.preventDefault(),z.directionWatcher.set(w)}),$(document).on("touchend mousedown","#down",function(t){t.preventDefault(),z.directionWatcher.set(b)}),$(document).on("touchend mousedown","#left",function(t){t.preventDefault(),z.directionWatcher.set(y)}),$(document).on("touchend mousedown","#right",function(t){t.preventDefault(),z.directionWatcher.set(X)}),$(document).on("click",".button#newGame",function(t){i.newGame()}),$(document).on("click",".button#highscore",function(t){i.showContent("highscore-content"),d()}),$(document).on("click",".button#instructions",function(t){i.showContent("instructions-content")}),$(document).on("click",".button#info",function(t){i.showContent("info-content")}),$(document).on("click",".button#back",function(t){i.showContent("game-content")}),$(document).on("click",".controlSound",function(t){i.toggleSound()}),$(document).on("click","#updateCode",function(t){console.log("check for new version"),t.preventDefault(),window.applicationCache.update()}),t=$("#myCanvas").get(0),e=t.getContext("2d"),i.init(0),g.disableLogger(),k()})}()}]);
//# sourceMappingURL=pacman.js.map